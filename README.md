# üîç File Integrity Monitoring (FIM) on Windows & Linux

This project demonstrates how to implement a **File Integrity Monitoring** (FIM) system on both Windows and Linux using native scripting. It helps detect unauthorized file changes and supports basic real-time alerting and forensic investigation ‚Äî especially useful for personal labs and lightweight endpoint monitoring.



## üìå Project Objective

- Track file modifications (creation, alteration, deletion) in critical directories.
- Maintain historical integrity via hash comparisons.
- Log suspicious changes for audit or further analysis.
- Practice log collection, automation, and response scripting.



## üõ†Ô∏è Tools & Technologies

- **PowerShell** ‚Äì for monitoring in Windows
- **Bash / Cron** ‚Äì for Linux systems
- **Event Viewer** (Windows) / **Syslog** (Linux)
- Optional: **Splunk**, **ELK Stack**, or any SIEM for centralized logging and analysis



## üñ•Ô∏è File Monitoring Logic

The script checks hash changes for specific files or scans directories recursively. When a change is detected, it logs the details locally and (optionally) sends alerts.


## ü™ü File Monitoring on Windows

### üîß Setup

1. **Install PowerShell**:
   Ensure that **PowerShell** is installed and configured on your Windows machine.

2. **Create Monitoring Directory**:
   Choose or create a directory that you want to monitor for file integrity. For example, create a folder named `Files` inside your project directory (`C:\FileMonitoring\Files`).

3. **Download or Create the Monitoring Script**:
   Download the PowerShell monitoring script from this [link to PowerShell script](/Windows/FIM.ps1). This script will monitor files in the specified directory and track any changes based on their SHA-512 hashes.

4. **Configure Baseline File**:
   - The script begins by creating a baseline of file hashes. This baseline is stored in a file called `baseline.txt`. If the file already exists, it will be erased to create a new one.
   - If you choose to collect a new baseline (`A`), the script will calculate the hash of each file in the `Files` folder and save it to `baseline.txt`.

5. **Run the Script**:
   - Open **PowerShell** as Administrator.
   - Navigate to the directory where you saved the script (`monitor.ps1`).
   - Run the script by executing:
     ```powershell
     .\monitor.ps1
     ```

   When prompted, you can choose to either:
   - **A**: Collect a new baseline (this will calculate and store the hash of each file in `baseline.txt`).
   - **B**: Begin monitoring files using the previously saved baseline.

6. **Monitor Files**:
   After choosing **B** to begin monitoring, the script will continuously check the files in the `Files` folder for any changes. It will notify you if:
   - A new file is created.
   - An existing file has been changed (hash mismatch).
   - A file from the baseline has been deleted.

   The script will notify you of these changes in real-time via the console with color-coded alerts:
   - Green: A new file has been created.
   - Yellow: A file has been changed.
   - Dark Red: A file has been deleted.

7. **Automate the Script**:
   For continuous monitoring, schedule the PowerShell script to run at regular intervals using **Windows Task Scheduler**:
   - Open **Task Scheduler** and create a new task.
   - Set the task to run the PowerShell script at your desired frequency (e.g., daily, weekly).
   - You can refer to the [Task Scheduler setup guide](YOUR_LINK_HERE) for more details.

---
## üìä Sample Output

The PowerShell script logs any changes (creation, modification, deletion) to the files in the specified directory. Below is an example of what the log file (`file_change_log.txt`) might look like after running the script.

### Sample Log Output:

<!-- ‚Ä¶ ```text
[2025-04-22 14:31:12] Modified: C:\Users\Public\Documents\plan.docx
[2025-04-22 14:35:01] Created: C:\Users\Public\Documents\newfile.txt
[2025-04-22 14:45:30] Deleted: C:\Users\Public\Documents\oldfile.txt
``` -->

### Key Points:
- This section explains the sample log output format that gets generated by the script.
- The log includes timestamps, file actions (modified, created, deleted), and file paths.
- You can link to or upload a screenshot showing the actual log output on your local system or in a virtual environment.

## üß† Key Learnings

- **File Integrity Monitoring (FIM)**: Implemented file monitoring on Windows using PowerShell and Linux using Bash, focusing on real-time detection of file changes like creation, modification, and deletion.

- **Hashing for Integrity**: Used SHA-256 hashing to detect unauthorized file changes, ensuring data integrity and providing a secure mechanism to verify file states.

- **Automation**: Automated the file monitoring process with PowerShell scripts and scheduled them to run periodically via Windows Task Scheduler, ensuring continuous monitoring.

- **Cross-Platform Application**: Gained experience applying the same file integrity monitoring techniques on both Windows and Linux platforms, using platform-specific tools like PowerShell and Bash.

- **Log Management**: Learned to capture and analyze file change logs, which can be used for security auditing and identifying suspicious activity.

- **Real-Time Threat Detection**: Set up a system that logs and alerts on file changes, improving proactive security and threat detection capabilities.

- **Problem-Solving**: Overcame configuration and troubleshooting challenges, such as file path issues and task scheduling, strengthening my troubleshooting skills.

This project not only solidified my understanding of **file integrity monitoring** but also sharpened my skills in **scripting**, **automation**, and **log analysis**, all of which are essential for any cybersecurity professional.
